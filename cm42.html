<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Securities Transfer Form (South Africa)</title>

    <!-- Google Font Import for Roboto -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

    <style>
        /* MODIFICATION: Global font set to Roboto */
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 850px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border: 1px solid #ddd;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
        }

        h1,
        h2,
        h3 {
            color: #2c3e50;
            margin-bottom: 0.5em;
        }

        h1 {
            text-align: center;
            font-size: 24px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        h2 {
            text-align: center;
            font-size: 16px;
            font-weight: normal;
            color: #555;
            margin-top: 0;
            margin-bottom: 30px;
        }

        h3 {
            font-size: 18px;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            margin-top: 30px;
        }

        /* MODIFICATION: Made form sections stand out */
        .form-section {
            margin-bottom: 25px;
            background-color: #f8f9fa;
            /* Light background color */
            padding: 20px;
            border-radius: 8px;
            /* Rounded corners */
            border: 1px solid #e9ecef;
            /* Subtle border */
        }

        /* MODIFICATION: Adjusted h3 margin inside the new section style */
        .form-section h3 {
            margin-top: 0;
            margin-bottom: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            align-items: start;
        }

        label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }

        input[type="text"],
        input[type="number"],
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 15px;
            font-family: 'Roboto', sans-serif;
            /* Ensure inputs inherit font */
        }

        input.date-input {
            background-color: #fff;
            cursor: pointer;
        }

        textarea {
            resize: vertical;
            min-height: 125px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .half-width-input {
            width: 50% !important;
        }

        .signature-box {
            border: 1px solid #ccc;
            margin-top: 5px;
            padding: 10px;
            height: 100px;
            background-color: #fff;
            /* Ensure signature box is white */
        }

        .signature-label {
            font-size: 12px;
            color: #777;
            text-align: center;
            margin-top: 10px;
        }

        .disclaimer {
            font-size: 12px;
            color: #888;
            margin-top: 40px;
            text-align: justify;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }

        .twothirds-width {
            width: 66.67%;
        }

        @media print {
            body {
                background-color: #fff;
                padding: 0;
                font-size: 12pt;
            }

            .container {
                box-shadow: none;
                border: none;
                padding: 0;
            }

            h1 {
                font-size: 20pt;
            }

            h2 {
                font-size: 14pt;
            }

            h3 {
                font-size: 14pt;
            }

            input,
            textarea {
                border: 1px solid #999;
            }

            .form-grid {
                grid-template-columns: 1fr 1fr;
            }

            .form-section {
                background-color: #fff !important;
                /* Remove background for printing */
                border: 1px solid #ccc;
                padding: 15px;
            }

            .disclaimer {
                display: none;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>Securities Transfer Form - CM42</h1>
        <h2>In terms of the Companies Act, 71 of 2008 and the Securities Transfer Tax Act, 25 of 2007</h2>

        <div class="form-section">
            <h3>A. Details of Securities Being Transferred</h3>
            <div class="form-grid">
                <div class="full-width"><label for="issuer-name">Full Name of issuer of security as shown on
                        certificate</label><input type="text" id="issuer-name" name="issuer_name"></div>
                <div><label for="security-description">Description of Securities</label><input type="text"
                        id="security-description" name="security_description"></div>
                <div><label for="certificate-numbers">Share Certificate Number(s)</label><input type="text"
                        id="certificate-numbers" name="certificate_numbers"></div>
                <div><label for="quantity-figures">Quantity in Figures</label><input type="number" id="quantity-figures"
                        name="quantity_figures" class="half-width-input"></div>
                <div><label for="quantity-words">Quantity in Words</label><input type="text" id="quantity-words"
                        name="quantity_words"></div>
            </div>
        </div>

        <div class="form-section">
            <h3>B. Transfer FROM (Details of current holder / Transferor)</h3>
            <div class="form-grid">
                <div><label for="transferor-name">Full Name(s) as per Share Register</label><input type="text"
                        id="transferor-name" name="transferor_name"></div>
                <div><label for="transferor-id">ID / Company Registration Number</label><input type="text"
                        id="transferor-id" name="transferor_id" class="half-width-input"></div>
                <div class="full-width">
                    <p style="font-size: 13px; margin: 15px 0 5px 0;">I/We, the undersigned, hereby transfer the
                        above-mentioned securities from the name(s) aforesaid.</p>
                </div>
                <div><label>Signature of Transferor(s) or Authorised Agent</label>
                    <div class="signature-box"></div>
                    <div class="signature-label">Signature</div>
                </div>
                <div><label for="signature-date">Date of Signature</label><input type="text" id="signature-date"
                        name="signature_date" class="date-input" placeholder="DD/MM/YYYY"></div>
            </div>
        </div>

        <div class="form-section">
            <h3>C. Transfer TO (Details of new holder / Transferee)</h3>
            <div class="form-grid">
                <div>
                    <label for="transferee-name">Full Name(s) of New Holder</label>
                    <input type="text" id="transferee-name" name="transferee_name">
                </div>
                <div>
                    <label for="transferee-id">ID / Company Registration Number</label>
                    <input type="text" id="transferee-id" name="transferee_id" class="half-width-input">
                </div>
                <div>
                    <label for="transferee-address">Full Postal Address</label>
                    <textarea id="transferee-address" name="transferee_address" rows="5"></textarea>
                </div>
                <div>
                    <div style="margin-bottom: 17px;">
                        <label for="transferee-phone">Cellphone Number</label>
                        <input type="text" id="transferee-phone" name="transferee_phone" class="half-width-input">
                    </div>
                    <div>
                        <label for="transferee-email">Email Address</label>
                        <input type="text" id="transferee-email" name="transferee_email" style="width: 70%;">
                    </div>
                </div>
            </div>
        </div>

        <div class="form-section">
            <h3>D. Consideration and Securities Transfer Tax (STT)</h3>
            <div class="form-grid">
                <div><label for="consideration-amount">Consideration (Price Paid)</label><input type="text"
                        id="consideration-amount" name="consideration_amount" placeholder="e.g. 555000.00"></div>
                <div><label for="transaction-date">Date of Transaction</label><input type="text" id="transaction-date"
                        name="transaction_date" class="date-input" placeholder="DD/MM/YYYY"></div>
            </div>
        </div>

        <div class="form-section">
            <h3>E. Lodged For Registration By</h3>
            <div>
                <div class="twothirds-width"><label for="lodging-agent">Name and Address of Person/Broker lodging this
                        form</label><input type="text" id="lodging-agent" name="lodging-agent"></div>
            </div>
        </div>

        <div class="disclaimer"><strong>Disclaimer:</strong> This is a template created by Holdstock & Watson Inc. and
            is intended for use in Share Transfers
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        // Wait for the document to be fully loaded before running scripts
        document.addEventListener('DOMContentLoaded', function ()
        {

            // Initialize flatpickr date pickers
            flatpickr(".date-input", {
                dateFormat: "d/m/Y",
            });

            // --- SCRIPT FOR CURRENCY FORMATTING ---

            // Function to format an input field's value as ZAR currency on blur (when user clicks away)
            const formatAsCurrency = (event) =>
            {
                const input = event.target;
                let value = input.value;

                // If the value is empty or already formatted, do nothing
                if (!value || value.startsWith('R '))
                {
                    return;
                }

                // 1. Sanitize the input to get a clean number. 
                //    This removes anything that isn't a digit or a decimal separator (dot/comma).
                let numericValue = parseFloat(value.replace(/[^0-9.,]/g, '').replace(',', '.'));

                // 2. Check if the result is a valid number
                if (!isNaN(numericValue))
                {
                    // 3. Format the number using the built-in Internationalization API.
                    //    'en-ZA' locale is for South Africa, which correctly uses 'R' and comma separators.
                    const formatter = new Intl.NumberFormat('en-ZA', {
                        style: 'currency',
                        currency: 'ZAR',
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });

                    // 4. Update the input field with the nicely formatted value
                    input.value = formatter.format(numericValue);
                } else
                {
                    // If the input was not a valid number (e.g., "abc"), clear the field.
                    input.value = '';
                }
            };

            // 5. Get the input fields that need currency formatting
            const considerationInput = document.getElementById('consideration-amount');

            // NOTE: 'market-value' input was in the script but not in the HTML. I've removed the reference to it.
            // const marketValueInput = document.getElementById('market-value');

            // 6. Attach the formatting function to the 'blur' event of each field
            if (considerationInput)
            {
                considerationInput.addEventListener('blur', formatAsCurrency);
            }
        });
    </script>
</body>

</html>